<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Analysis
  
  #
  

I will be explaining how you can analyze the point sources detected by Fermi LAT.

  Background model download
  
  #
  

We need to download the latest Galactic interstellar emission model and the Isotropic spectral template from this page. So download the gll_iem_v07.fits and iso_P8R3_SOURCE_V3_v1.txt for Event Selection of Pass 8 Source.
Additionally, I will suggest downloading the latest Fermi LAT catalog in FITS format from this link.
Keep all these files in a separate folder, so that we can use them for each analysis."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://joysankar-astro.github.io/astro-notes/docs/fermi-lat-analysis/analysis/"><meta property="og:site_name" content="Astro-Notes"><meta property="og:title" content="Astro-Notes"><meta property="og:description" content="Analysis # I will be explaining how you can analyze the point sources detected by Fermi LAT.
Background model download # We need to download the latest Galactic interstellar emission model and the Isotropic spectral template from this page. So download the gll_iem_v07.fits and iso_P8R3_SOURCE_V3_v1.txt for Event Selection of Pass 8 Source.
Additionally, I will suggest downloading the latest Fermi LAT catalog in FITS format from this link.
Keep all these files in a separate folder, so that we can use them for each analysis."><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>Analysis | Astro-Notes</title><link rel=icon href=/astro-notes/favicon.png><link rel=manifest href=/astro-notes/manifest.json><link rel=canonical href=https://joysankar-astro.github.io/astro-notes/docs/fermi-lat-analysis/analysis/><link rel=stylesheet href=/astro-notes/book.min.639749708159028ec33cbaaabc38c7aa7fd1c38feeda955a951da11021b3aaee.css integrity="sha256-Y5dJcIFZAo7DPLqqvDjHqn/Rw4/u2pValR2hECGzqu4=" crossorigin=anonymous><script defer src=/astro-notes/fuse.min.js></script><script defer src=/astro-notes/en.search.min.db477dcd60be069df2bc4ed1fd8193f24bb0cd73aaaa9d506d59dcfac3b2fad1.js integrity="sha256-20d9zWC+Bp3yvE7R/YGT8kuwzXOqqp1QbVnc+sOy+tE=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://joysankar-astro.github.io/astro-notes/docs/fermi-lat-analysis/analysis/index.xml title=Astro-Notes></head><body dir=ltr class="book-kind-section book-type-docs"><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/astro-notes/><span>Astro-Notes</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><input type=checkbox id=section-3d058a30a3ff119b15931a520f6e39dc class=toggle checked>
<label for=section-3d058a30a3ff119b15931a520f6e39dc class=flex><a href=/astro-notes/docs/fermi-lat-analysis/ class=flex-auto>Fermi LAT Analysis</a></label><ul><li><a href=/astro-notes/docs/fermi-lat-analysis/installation/>Installation</a><ul></ul></li><li><a href=/astro-notes/docs/fermi-lat-analysis/analysis/ class=active>Analysis</a><ul></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/astro-notes/svg/menu.svg class=book-icon alt=Menu></label><h3>Analysis</h3><label for=toc-control><img src=/astro-notes/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#analysis>Analysis</a><ul><li><a href=#background-model-download>Background model download</a></li><li><a href=#data-download>Data download</a></li><li><a href=#configuration-file>Configuration file</a></li><li><a href=#notebook-analysis>Notebook analysis</a><ul><li></li></ul></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=analysis>Analysis
<a class=anchor href=#analysis>#</a></h1><p>I will be explaining how you can analyze the point sources detected by Fermi LAT.</p><h2 id=background-model-download>Background model download
<a class=anchor href=#background-model-download>#</a></h2><p>We need to download the latest Galactic interstellar emission model and the Isotropic spectral template from this <a href=https://fermi.gsfc.nasa.gov/ssc/data/access/lat/BackgroundModels.html>page</a>. So download the <em>gll_iem_v07.fits</em> and <em>iso_P8R3_SOURCE_V3_v1.txt</em> for Event Selection of Pass 8 Source.</p><p>Additionally, I will suggest downloading the latest Fermi LAT catalog in FITS format from this <a href=https://fermi.gsfc.nasa.gov/ssc/data/access/lat/14yr_catalog/>link</a>.</p><p>Keep all these files in a separate folder, so that we can use them for each analysis.</p><h2 id=data-download>Data download
<a class=anchor href=#data-download>#</a></h2><p>Download the data for your specified source from the <a href=https://fermi.gsfc.nasa.gov/cgi-bin/ssc/LAT/LATDataQuery.cgi>link</a>.</p><img width=610 height=290 alt=image src=https://github.com/user-attachments/assets/c0af4537-753e-4d11-9a81-8fbb9a390b0b><p>For time conversion, you can use the <a href=https://heasarc.gsfc.nasa.gov/cgi-bin/Tools/xTime/xTime.pl>xTime</a> tool.</p><p>Conventionally, we choose a search radius of 20$<code>\degree</code>$. Fermi LAT operates in the energy range ~20 MeV to >300 GeV, but we can generally choose 100 MeV to 500 GeV. We need the spacecraft file also for analysis.</p><p>Now download all the files in a separate folder. Some files will contain <em>PH</em>, and some will contain <em>SC</em> in their names. The <em>PH</em> files hold the photon data, and <em>SC</em> will hold the spacecraft data during that observation. Now, create a file that contains the list of <em>PH</em> files using the code in the terminal opened in the same folder</p><pre tabindex=0><code>ls *PH* &gt; ph_list.dat
</code></pre><p>It will create a <code>ph_list.dat</code> file, which will list the <em>PH</em> files.</p><blockquote class='book-hint caution'><p>Make sure that the folder you create does not contain any spaces; otherwise, your analysis will fail.</p></blockquote><h2 id=configuration-file>Configuration file
<a class=anchor href=#configuration-file>#</a></h2><p>You need to create a <code>config.yaml</code> file in that folder where the data is located. It is like a simple text file, which contains the configuration information. This file will be structured as below</p><pre tabindex=0><code class=language-YML data-lang=YML>data:
  evfile : ph_list.dat
  scfile : L250815080059DAC8B79833_SC00.fits

binning:
  roiwidth   : 20.0
  binsz      : 0.1
  binsperdec : 8

selection :
  emin : 100
  emax : 500000
  zmax    : 90
  evclass : 128
  evtype  : 3
  tmin : 757382405.0
  tmax : 776908805.0
  filter : &#39;DATA_QUAL&gt;0 &amp;&amp; LAT_CONFIG==1&#39;
  target : &#39;3C 138&#39;

gtlike:
  edisp: true
  irfs: &#39;P8R3_SOURCE_V3&#39;
  edisp_disable : [&#39;isodiff&#39;,&#39;galdiff&#39;]

model:
  src_radius : 15.0
  catalogs : &#39;/home/joysankar/fermi-catlog/gll_psc_v35.fit&#39;
  galdiff  : &#39;/home/joysankar/fermi-catlog/gll_iem_v07.fits&#39;
  isodiff  : &#39;/home/joysankar/fermi-catlog/iso_P8R3_SOURCE_V3_v1.txt&#39;
</code></pre><p>The <code>evfile</code> is the name of the <em>PH</em> file list, which we have created previously. <code>scfile</code> is the spacecraft file you have already downloaded. Make sure to set emin (MeV), emax(MeV), tmin (MET), and tmax (MET). In <code>target</code>, put the object name, but better to use the 4FGL name. Make sure to give the appropriate path of catalogs, galdiff, and isodiff. <code>binsperdec</code> is a factor that determines the binning.</p><h2 id=notebook-analysis>Notebook analysis
<a class=anchor href=#notebook-analysis>#</a></h2><p>Now open a terminal in that folder and activate the <code>fermipy</code> environment.</p><pre tabindex=0><code>conda activate fermipy
</code></pre><p>Then open a Jupyter Notebook and run the code attached below step by step.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> fermipy.gtanalysis <span style=color:#f92672>import</span> GTAnalysis
</span></span><span style=display:flex><span>gta <span style=color:#f92672>=</span> GTAnalysis(<span style=color:#e6db74>&#39;config.yaml&#39;</span>,logging<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;verbosity&#39;</span> : <span style=color:#ae81ff>3</span>})
</span></span><span style=display:flex><span>gta<span style=color:#f92672>.</span>setup()
</span></span></code></pre></div><p>It will take time and perform the initial analysis.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>gta<span style=color:#f92672>.</span>optimize()
</span></span></code></pre></div><p>It will fit the spectral parameters of the source.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>gta<span style=color:#f92672>.</span>print_roi()
</span></span></code></pre></div><p>It will show the sources with TS values
Now we&rsquo;ll free the sources within the 3$<code>\degree</code>$ of ROI.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>gta<span style=color:#f92672>.</span>free_sources(free<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>gta<span style=color:#f92672>.</span>free_sources(distance<span style=color:#f92672>=</span><span style=color:#ae81ff>3.0</span>,pars<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;norm&#39;</span>)
</span></span><span style=display:flex><span>gta<span style=color:#f92672>.</span>free_source(<span style=color:#e6db74>&#39;4FGL J2321.9+2734&#39;</span>)
</span></span><span style=display:flex><span>gta<span style=color:#f92672>.</span>free_source(<span style=color:#e6db74>&#39;galdiff&#39;</span>)
</span></span><span style=display:flex><span>gta<span style=color:#f92672>.</span>free_source(<span style=color:#e6db74>&#39;isodiff&#39;</span>)
</span></span></code></pre></div><p>You need to fit the parameters by running the code below</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>gta<span style=color:#f92672>.</span>fit()
</span></span></code></pre></div><h4 id=sed-analysis>SED analysis
<a class=anchor href=#sed-analysis>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>sed <span style=color:#f92672>=</span> gta<span style=color:#f92672>.</span>sed(<span style=color:#e6db74>&#39;4FGL J2321.9+2734&#39;</span>,make_plots<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span></code></pre></div><p>It will generate a file like <code>4fgl_j0521.2+1637_sed.fits</code> which will be used for SED plotting.</p><h4 id=light-curve-analysis>Light curve analysis
<a class=anchor href=#light-curve-analysis>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>lc <span style=color:#f92672>=</span> gta<span style=color:#f92672>.</span>lightcurve(<span style=color:#e6db74>&#39;4FGL J2321.9+2734&#39;</span>, binsz<span style=color:#f92672>=</span><span style=color:#ae81ff>21600.0</span>,outdir<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;6hrs_dir&#39;</span>, multithread<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>, nthread<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>, write_fits<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span></code></pre></div><p>It will generate a file like <code>4fgl_j1310.5+3221_lightcurve.fits</code> which will be used for light curve plotting. The binsz is the binning time in seconds. The multithread is for parallel calculation. The outdir is the directory where each bin file will be generated. The nthread is the number of parallel threads. It will take time based on the binning size.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><div class="flex flex-wrap justify-between"><span><a href=/astro-notes/docs/fermi-lat-analysis/installation/ class="flex align-center book-icon"><img src=/astro-notes/svg/backward.svg class=book-icon alt=Previous title=Installation>
<span>Installation</span>
</a></span><span></span></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#analysis>Analysis</a><ul><li><a href=#background-model-download>Background model download</a></li><li><a href=#data-download>Data download</a></li><li><a href=#configuration-file>Configuration file</a></li><li><a href=#notebook-analysis>Notebook analysis</a><ul><li></li></ul></li></ul></li></ul></nav></div></aside></main></body></html>